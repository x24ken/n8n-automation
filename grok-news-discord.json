{
  "name": "grok-news-discord",
  "nodes": [
    {
      "parameters": {
        "rule": {
          "interval": [
            {
              "field": "weeks",
              "triggerAtDay": [
                6
              ],
              "triggerAtHour": 9
            },
            {}
          ]
        }
      },
      "type": "n8n-nodes-base.scheduleTrigger",
      "typeVersion": 1.2,
      "position": [
        -1168,
        -144
      ],
      "id": "99b8f2f3-faa2-47d9-b47a-4d9636e5aa9d",
      "name": "Schedule Trigger"
    },
    {
      "parameters": {
        "jsCode": "const today = new Date();\nconst sixDaysAgo = new Date();\nsixDaysAgo.setDate(today.getDate() - 6);\n\nconst formatDate = (date) =>\ndate.toISOString().slice(0, 10);\n\nconst startDate = formatDate(sixDaysAgo);\nconst endDate = formatDate(today);\n\nconst prompt = `${startDate}〜${endDate}の週のAI活用ニュース、主には「新しいツールの登場、アップデート、具体的な活用方法」を集めてください。\n\n## ルール\n- 各ニュースの概要の末尾に元ポストのURLを書いてください\n- 「## 普段ウォッチしているアカウント」参考に似た系統の情報源からポストを集めてください\n\n## 普段ウォッチしているアカウント\nTestingCatalog News 🗞\n@testingcatalog\n\nAI Engineer\n@aiDotEngineer\n\nLangChain\n@LangChainAI\n\nHamel Husain\n@HamelHusain\n\nSam Altman\n@sama\n\nFirebase\n@Firebase\n\nGenspark (ジェンスパーク) : 日本公式\n@genspark_japan\n\nAnthropic\n@AnthropicAI\n\nChatGPT\n@ChatGPTapp\n\nn8n.io\n@n8n_io\n\nLatent.Space\n@latentspacepod\n`\n\nreturn [{ json: { prompt, startDate, endDate } }];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -960,
        -144
      ],
      "id": "d819f039-2379-418b-ad9d-cfb22bcc1ad3",
      "name": "Code"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://api.x.ai/v1/chat/completions",
        "authentication": "predefinedCredentialType",
        "nodeCredentialType": "xAiApi",
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "model",
              "value": "grok-4"
            },
            {
              "name": "search_parameters",
              "value": "={{ {   \"mode\": \"auto\",   \"from_date\": $json.startDate,   \"to_date\": $json.endDate,   \"max_search_results\": 30,   \"sources\": [{ \"type\": \"x\", \"post_favorite_count\": 60 }] } }}"
            },
            {
              "name": "messages",
              "value": "={{ [{ \"role\": \"user\", \"content\": $json.prompt }] }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -752,
        -144
      ],
      "id": "80259aec-040e-4b55-b432-b084319af054",
      "name": "HTTP Request",
      "credentials": {
        "xAiApi": {
          "id": "LW8POSgDNk4hQBrr",
          "name": "xAi account"
        }
      }
    },
    {
      "parameters": {
        "fieldToSplitOut": "chunks",
        "options": {}
      },
      "type": "n8n-nodes-base.splitOut",
      "typeVersion": 1,
      "position": [
        -48,
        -144
      ],
      "id": "6117592b-0191-498b-b628-abea7f964719",
      "name": "Split Out"
    },
    {
      "parameters": {
        "authentication": "webhook",
        "content": "={{ $json.chunks }}",
        "options": {}
      },
      "type": "n8n-nodes-base.discord",
      "typeVersion": 2,
      "position": [
        160,
        -144
      ],
      "id": "6a7b8d15-66ac-4aee-bf91-39bd4c14bb5d",
      "name": "Discord",
      "webhookId": "0f7f1f61-6406-4dfb-9927-88fffaf26c9a",
      "credentials": {
        "discordWebhookApi": {
          "id": "GESVhDerfZa7lLky",
          "name": "Discord Webhook account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "const splitBy2000Characters = (text) => {\n  const chunkSize = 2000;\n  const result = [];\n\n  for (let i = 0; i < text.length; i += chunkSize) {\n    result.push(text.slice(i, i + chunkSize));\n  }\n\n  return result;\n}\n\nconst chunks = splitBy2000Characters($input.first().json.choices[0].message.content)\n\nreturn [{ json: { chunks } }];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -512,
        -144
      ],
      "id": "f816d59d-13b7-49e3-ae4f-e5445eafa12a",
      "name": "Code1"
    }
  ],
  "pinData": {},
  "connections": {
    "Schedule Trigger": {
      "main": [
        [
          {
            "node": "Code",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code": {
      "main": [
        [
          {
            "node": "HTTP Request",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Split Out": {
      "main": [
        [
          {
            "node": "Discord",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code1": {
      "main": [
        [
          {
            "node": "Split Out",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTTP Request": {
      "main": [
        [
          {
            "node": "Code1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": true,
  "settings": {
    "executionOrder": "v1"
  },
  "versionId": "df450851-554f-433d-bf07-d631efcee43d",
  "meta": {
    "instanceId": "b6e990f210fa44870ca0bb1387222c6b940dbc8d2ab05eac96a53521aa849f5e"
  },
  "id": "w7FXk1nh1cAPx0v4",
  "tags": []
}